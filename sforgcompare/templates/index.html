{% extends 'base.html' %}

{% block scripts %}
	<script>
		$(document).ready(function() 
		{
			$('[data-toggle="popover"]').popover();
		});
	</script>
{% endblock %}

{% block content %}

	<div class="inner">

		<h1>Salesforce Org Compare</h1>
		<p>
			This tool uses the Salesforce Tooling or Metadata API (user selection) to compare metadata between two Orgs. This is useful when planning deployments or building deployment packages, as well as seeing what configuration exists in Production to Sandbox or between Sandbox environments.
		</p>
		<p>
			None of your organisation information or data is captured or kept from running this tool.
		</p>

		<div class="left-half">

			<h2>Org One</h2>

			<table id="orgOneLogin">

				<tr>
					<td width="125">
						<select id="org_one_env" name="org_one_env" class="form-control">
							<option value="Production">Production</option>
							<option value="Sandbox">Sandbox</option>
						</select>
					</td>
					<td>
						&nbsp;&nbsp;
						<button type="button" id="orgOneButton">
  							Login
						</button>
					</td>
				</tr>

			</table>

			<table id="orgOneDisplay" style="display:none;">

				<tr>
					<td width="90">
						<strong>Username</strong>
					</td>
					<td>
						<span id="orgOneUsername"></span>
					</td>
				</tr>

				<tr>
					<td>
						<strong>Org</strong>
					</td>
					<td>
						<span id="orgOneOrg"></span>
					</td>
				</tr>

			</table>

		</div>

		<div class="right-half">

			<h2>Org Two</h2>

			<table id="orgTwoLogin">

				<tr>
					<td width="125">
						<select id="org_two_env" name="org_two_env" class="form-control">
							<option value="Production">Production</option>
							<option value="Sandbox">Sandbox</option>
						</select>
					</td>
					<td>
						&nbsp;&nbsp;
						<button type="button" id="orgTwoButton">
  							Login
						</button>
					</td>
				</tr>

			</table>

			<table id="orgTwoDisplay" style="display:none;">

				<tr>
					<td width="90">
						<strong>Username</strong>
					</td>
					<td>
						<span id="orgTwoUsername"></span>
					</td>
				</tr>

				<tr>
					<td>
						<strong>Org</strong>
					</td>
					<td>
						<span id="orgTwoOrg"></span>
					</td>
				</tr>

			</table>

		</div>

		<div class="clear"></div>

		<div id="compareOrgs">

			<form action="." method="POST">

				{% csrf_token %}

				<select id="id_api_choice" name="api_choice" class="form-control" style="float:left;">
					<option value="tooling">Tooling API</option>
					<option value="metadata">Metadata API</option>
				</select>

				<img src="/static/images/i-icon.png" id="info_icon" data-toggle="modal" data-target="#apiModal" />

				<input type="submit" id="submitCompare" value="Compare Orgs" style="float:left;"/>

				<input type="hidden" id="client_id" value="{{ client_id }}" />
				<input type="hidden" id="redirect_uri" value="{{ redirect_uri }}" />
				<input type="hidden" id="id_org_one" name="org_one" />
				<input type="hidden" id="id_org_two" name="org_two" />

			</form>

		</div>

	</div>

	<div class="modal fade" id="apiModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
		<div class="modal-dialog">
	    	<div class="modal-content">
	      		<div class="modal-header">
	        		<button type="button" class="close" data-dismiss="modal">
	        			<span aria-hidden="true">&times;</span>
	        			<span class="sr-only">Close</span>
	        		</button>
	        		<h3 class="modal-title" id="myModalLabel">
	        			API Selection
	        		</h3>
	      		</div>
	      		<div class="modal-body">
	        		<h4>
	        			Tooling API
	        		</h4>
	        		<p>
	        			The Tooling API is much faster in querying the metadata and will return the org compare results a lot faster. However, the Tooling API is limited to the <a href="#" data-toggle="popover" title="Supported Metadata" data-content="ApexClass <br/>ApexComponent<br/>ApexPage<br/>ApexTrigger<br/>CompactLayout<br/>CustomField<br/>CustomObject<br/>EmailTemplate<br/>Layout<br/>Profile<br/>RecordType<br/>StaticResource<br/>ValidationRule<br/>WorkflowAlert<br/>WorkflowFieldUpdate<br/>WorkflowOutboundMessage<br/>WorkflowRule<br/>WorkflowTask" data-html="true" data-trigger="focus">following types of metadata</a>.
	        		</p>

	        		<br/>

	        		<h4>
	        			Metadata API
	        		</h4>
	        		<p>
	        			The Metadata API is slower but returns the full set of queryable metadata for your Org. Use the Metadata API if there are components not contained in the Tooling API that you would like to compare. This should be used if you want a true <strong>full</strong> comparison between two Orgs.
	        			<br/><br/>
	        			Note: The Metadata API is limited to 5,000 files retrieved in a single call.
	        		</p>
	      		</div>
	    	</div>
	  	</div>
	</div>

	<!-- Force logout when page is loaded -->
	<iframe src="https://login.salesforce.com/secur/logout.jsp" width="0" height="0" style="display:none;"></iframe>
    <iframe src="https://test.salesforce.com/secur/logout.jsp" width="0" height="0" style="display:none;"></iframe>

{% endblock %}